{% extends "base.html" %}
{% block title %}Blog Posts{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Latest Blogs</h2>
    {% if current_user.is_authenticated %}
        <a href="{{ url_for('create_post') }}" class="btn btn-primary">
            + New Post
        </a>
    {% endif %}
</div>


{% if posts %}
<div class="row g-4">
    {% for post in posts %}
    <div class="col-md-6 col-lg-4">
        <div class="card h-100 border-0 shadow-sm post-card">

            <!-- Post Image -->
            <div class="position-relative">
                {% if post.image_url %}
                    <img src="{{ post.image_url }}"
                         class="card-img-top"
                         alt="{{ post.title }}">
                {% else %}
                    <img src="{{ url_for('static', filename='images/flask_theme.jpg') }}"
                         class="card-img-top"
                         alt="Default Image">
                {% endif %}
            </div>

            <div class="card-body d-flex flex-column">

                <!-- Title -->
                <h5 class="card-title mb-2">
                    <a href="{{ url_for('post_detail', post_id=post.id) }}"
                    class="text-decoration-none text-dark stretched-link">
                        {{ post.title }}
                    </a>
                </h5>

                <!-- Meta -->
                <p class="text-muted small mb-2">
                    {{ post.created_at.strftime('%b %d, %Y') }}
                    {% if post.updated_at %}
                        · Updated {{ post.updated_at.strftime('%b %d, %Y') }}
                    {% endif %}
                    &nbsp;
                    <!-- Category -->
                    {% if post.category %}
                        <span class="badge bg-secondary mb-2 align-self-start">
                            {{ post.category.name }}
                        </span>
                    {% endif %}
                </p>

                <!-- Excerpt -->
                {% if post.content %}
                    <p class="card-text text-muted mb-3">
                        {{ post.content[:90] }}{% if post.content|length > 90 %}...{% endif %}
                    </p>
                {% endif %}

                <!-- CTA -->
                <div class="mt-auto">
                    <span class="btn btn-outline-primary btn-sm">
                        Read More →
                    </span>
                </div>

            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<p class="text-muted">No posts available.</p>
{% endif %}




{% endblock %}
